---
title: "[Python] 데이터프레임 응용(3) - 그룹 연산"
excerpt: "0605 데이터프레임 응용(3) - 그룹 연산"

categories:
  - 데이터 분석
tags:
  - []

permalink: /DA/lesson7-2/

toc: true
toc_sticky: ture

date: 2023-06-05
last_modified_at: 2023-06-05
---

## 그룹 객체 만들기

```python
# 라이브러리 불러오기
import seaborn as sns
import pandas as pd

# 데이터 불러오기
titanic = sns.load_dataset('titanic')
df = titanic.loc[:, ['sex', 'age','fare','class','survived']]

# 데이터 개수
len(df) # 891
```

- 1개의 열로 그룹 객체 만들기

```python
# 그룹 객체 => groupby(그룹화에 사용할 열)
grouped = df.groupby('sex')
print(grouped) # => 그룹 객체
---------------------------------------------------------
# <pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f809792bc10>
```

```python
# 성별 그룹 확인
df['sex'].value_counts()
---------------------------------
# male      577
# female    314
# Name: sex, dtype: int64


# 반복문으로 그룹 객체 확인
for i,j in grouped:
  print('그룹의 이름: ', i) # 그룹의 이름
  print(j.head()) # 그룹에 해당하는 데이터
--------------------------------------------
# 그룹의 이름:  female
#       sex   age     fare   class  survived
# 1  female  38.0  71.2833   First         1
# 2  female  26.0   7.9250   Third         1
# 3  female  35.0  53.1000   First         1
3 8  female  27.0  11.1333   Third         1
# 9  female  14.0  30.0708  Second         1
# 그룹의 이름:  male
#     sex   age     fare  class  survived
# 0  male  22.0   7.2500  Third         0
# 4  male  35.0   8.0500  Third         0
# 5  male   NaN   8.4583  Third         0
# 6  male  54.0  51.8625  First         0
# 7  male   2.0  21.0750  Third         0
```

```python
# 그룹 객체에서 원하는 그룹의 데이터를 가져오기
df_female = grouped.get_group('female')
df_female.head()
-----------------------------------------
# 	sex	age	fare	class	survived
# 1	female	38.0	71.2833	First	1
# 2	female	26.0	7.9250	Third	1
# 3	female	35.0	53.1000	First	1
# 8	female	27.0	11.1333	Third	1
# 9	female	14.0	30.0708	Second	1
```

- 여러 개 열로 그룹 객체 만들기

```python
# 그룹 객체 => groupby(그룹화에 사용할 열)
grouped = df.groupby(['class','sex'])
print(grouped) # => 그룹 객체
----------------------------------------
<pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f80976dfc40>
```

```python
# 성별 그룹 확인
df[['class','sex']].value_counts()
------------------------------------
# class   sex   
# Third   male      347
#         female    144
# First   male      122
# Second  male      108
# First   female     94
# Second  female     76
# dtype: int64

# 반복문으로 그룹 객체 확인
for i,j in grouped:
  print('그룹의 이름: ', i) # 그룹의 이름 => 튜플 형태
  print(j.head()) # 그룹에 해당하는 데이터
------------------------------------------------
# 그룹의 이름:  ('First', 'female')
#        sex   age      fare  class  survived
# 1   female  38.0   71.2833  First         1
# 3   female  35.0   53.1000  First         1
# 11  female  58.0   26.5500  First         1
# 31  female   NaN  146.5208  First         1
# 52  female  49.0   76.7292  First         1
# 그룹의 이름:  ('First', 'male')
#      sex   age      fare  class  survived
# 6   male  54.0   51.8625  First         0
# 23  male  28.0   35.5000  First         1
# 27  male  19.0  263.0000  First         0
# 30  male  40.0   27.7208  First         0
# 34  male  28.0   82.1708  First         0
# 그룹의 이름:  ('Second', 'female')
#        sex   age     fare   class  survived
# 9   female  14.0  30.0708  Second         1
# 15  female  55.0  16.0000  Second         1
# 41  female  27.0  21.0000  Second         0
# 43  female   3.0  41.5792  Second         1
# 53  female  29.0  26.0000  Second         1
# 그룹의 이름:  ('Second', 'male')
#      sex   age  fare   class  survived
# 17  male   NaN  13.0  Second         1
# 20  male  35.0  26.0  Second         0
# 21  male  34.0  13.0  Second         1
# 33  male  66.0  10.5  Second         0
# 70  male  32.0  10.5  Second         0
# 그룹의 이름:  ('Third', 'female')
#        sex   age     fare  class  survived
# 2   female  26.0   7.9250  Third         1
# 8   female  27.0  11.1333  Third         1
# 10  female   4.0  16.7000  Third         1
# 14  female  14.0   7.8542  Third         0
# 18  female  31.0  18.0000  Third         0
# 그룹의 이름:  ('Third', 'male')
#      sex   age     fare  class  survived
# 0   male  22.0   7.2500  Third         0
# 4   male  35.0   8.0500  Third         0
# 5   male   NaN   8.4583  Third         0
# 7   male   2.0  21.0750  Third         0
# 12  male  20.0   8.0500  Third         0
```

```python
# 그룹 객체에서 원하는 그룹의 데이터를 가져오기
df_th_male = grouped.get_group(('Third','male')) # 튜플 형태
df_th_male.head()
------------------------------------------------
# 	sex	age	fare	class	survived
# 0	male	22.0	7.2500	Third	0
# 4	male	35.0	8.0500	Third	0
# 5	male	NaN	8.4583	Third	0
# 7	male	2.0	21.0750	Third	0
# 12	male	20.0	8.0500	Third	0
```

## 그룹 연산 메소드

### 집계


